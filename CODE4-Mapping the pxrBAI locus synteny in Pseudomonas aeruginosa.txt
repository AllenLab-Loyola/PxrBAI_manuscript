##############################################################################################
##############################################################################################
##########     Mapping the pxrBAI locus synteny in Pseudomonas aeruginosa.   #################
##############################################################################################
##############################################################################################


####This protocol identifies and generates trimmed gbk files for the 5 pxr loci in PA complete genomes
####SPINE/AGENT/CLUSTAGE/R pipeline determines strain relatedness for each loci
####Clinker is used to visualized locus synteny for representative strains.  

##########
##STEP 1##
########## 
####RUN BLAST using pxr Locus anchor genes
	Locus 1: PA2452 and PA2466
	Locus 2: PA3372 and PA3366 (tRNA-ARG)
	Locus 3: PA4524 and PA4538 (tRNA-Thr)
	Locus 4: PA5149 and PA5150 (tRNA-Phe)
	Locus 5: PA3536 and PA3537 (PA7 strains)


>PA2452
ATGTCTGCCGTTTCCACCTCGTTGTTGCTTTTCCTCAACCTGCTGACCCCGGCCCAGGCCGCCCAGCCCGTGCCGCTGGCCGATGGCCGCATCGAGATCGCTGCCGGCGAGAGCCGCCAGCGCTACCTCGACCTTGCCCCCGGCGAGTTGCAGTTGCTCGACCTGGAGGTCGACCGCGGCCGCGTCCGCCTGCGCGCCACCACGCCCGACGGCAAGGCGTTGCGCGCGACGGAGCTGGCCGGACGCCAGTCGCTCGGCCTGCAGGCCGGCGAGCGCCAGGGCCTGCGCCTGACCTTCAGCGCCGACGAAGACACCGCACTGACCCTGATCCCCACCCAGCGCCTCACCCCGCAGACCCCGGCGCTTGATTCACCGGTGCCGCAGAGCCCGACCCTGCAACGCCTGCAGGCGGAGCTTGCGGAAAAGCGCCCCGGCGCGCTGAAGGCGTTCTGGAAGCAGGTAGCGAAGCAGGGCACGCCGCTGGTGGAGCCGCTGGATGCCGAACGTGTGCTGGTCACCTTCCTCTGGCGCCAGCAGCGTCCCGGCGACGTGCGCCTGCTGTGGCCGACCCCGGAGGTCAACACCCGCCGCTTCGAGGCCCTGGCCGGCAGCGACGTACGCTACCTGAGCCTGCCGCTGCGCCGCGACGCGCGGGTTTCCTACCAGCTCAGCGCCGACCTGCCGGACCTGCAACAGGCCGATCGCGGCACCTTGCGCCTGGCCTTGCAGGCGGCGGCGCGGCCGGACCCGCTGAGCCGTACGCCGTGGCTCAATAGCCGCGCGCTGCCGCGGGCCGAGCAGGCCTCGCTGGTGCAGCTCGGCGGCGCCCCTGCCGAGACCTGGGACCAGCCGCGCAAGGACGTGCCGCGCGGCAAGGTGGAGCGCCTCGGCTATAGCAGCCAGGCCCTGGCCAACCAGCGCCACTGA

>PA2466|foxA
ATGACCGCCACCGCCGTCGTCCTCCGCAATGCCCCGTCGTCCCTCGATTTCCCCCGCGCCTCGCGCCTGAGCCGTTCGGTGCGCGCGGCCCTGCTGTCGTTGGCCATGGCGGCCGGCGCGGCGCCGCTCTGCGCCTCGGCCGCCGAAGCGGCGGCGGAACAGGCGCGGCCCTATGCGATCCCCGCCGGACAGTTGGGCGACGTGCTCAACCGCTTCGCCCGCGAAGCCGGCATCACCCTCTCGGCCACTCCGGCGCAGACCGGTGGCTACAGCTCCCAGGGGTTGCGCGGCAGTTTCACCGTGCAGCAGGGCCTGGCCCGGCTGCTCGCCGACACCCCGCTGGAAGCGGAAGACCAGGGCGACGGCAGCTTCGTCTTGCGCGAGGCGCCGGCAAAGGACGGCGATGTGCTGAACATGCAGGCGGTGGAGGTCTTCGCCCTCGGCAACAACCTGGGCAGCACCGATGGCTACCTGGCCACCCATAGCCAGATCGCCACCAAGACCAGCAAGCCGCTGCTGGAAACCAGCCAGACCGTCTCGGTGATCACCCGCGAGCAGATCGACGACACCGCCTCCAAGACCGTGCAGCAGGCGATGCGCTATACCCCCGGCATCTTCACCGGCCAGGTCGGCGCCTCCAACCGCTACGACTACGTGGTGATGCGCGGCTTCGCCGACAACAGCGTGGACAACATCTACCTCGACGGTCTCAAGGCCATGGGCGACAGCGGTACCTTCAGCTCGATGCAGGTCGACCCGTACTTCCTCGAACGCATCGATGTGCTCAAGGGGCCGTCCTCGGTGCTCTACGGCCGTAGCCTGCCGGGCGGCCTGGTGGCGCTGACCAGCAAGAAGCCGTTGTACGAGGACTACCGCCAGATCACCGGCAGCATCGGCAACATGGGCCAGAAGGAGATGGGCTTCGATTTCAGCGGGCCGCTCGACGAGGAGAAGCGCATCGCCTACCGCCTGATCGGTCTCGGCAAGGGCTCGGATACCCAGTTCGATCACGTCAAGGAGGAGCGCTACGCCATCGCCCCGACCCTGGCCATCGACTTCAGCGACGACACCACCCTGACCCTGCAAGGCTACCTGCAACACGATCCCAACGGGGGCTACCACGGCGGCGTACCGGCCGACGGCACCCTGTCGCACCACAACGGCCGGCACATCTCCCGCGAGTTCTTCGATGGCGAGCCGAGCAAGGACGACTTCGACCGCACCCAGCGGATGTTCGGCTACCAGCTGGAGCACCGCATCGACGACGTCTGGTCGGCGCGGCAGAACTTCCGCTACCTGGACTCCGACGTCGACCTGTCGCAGGTCTACGCCTACGGCTGGAGCGCCAGCGAGCCGAACAAGCTGAACCGCTACTTCAGCGGCGCCCGCGAGCACCTGCAGGCGTATATCGTCGACAACATGCTGCAGGCCGAATTCGCCACCGGCGCGGCGCGCCACACCCTGCTCACCGGCCTCGACTACCAGCGCCGGCGCACCGTGGTCGACTGGCGTTCCGGCTCGGCCTCGGCGCTGGACGCGTTCAACCCGGTCTACGGCGACGACGCCATCAGCTATTTCCCGGACGACAACCACACCCGCCGCCTGGAGCAGACCGGCGTCTACCTCCAGGACCTGATCGACATCGACCAGTGGCGCTTCTCGCTCGGCCTGCGCCAGGACTGGGTCAGCGTCACCGACAAGAACCGCAGCACCGGCAGCAAGGCCGACGACGACTGGGAGAAATTCACCGGGCGGATCGGCGCGCTGTACCTGTTCGACAACGGCCTGGCGCCCTACGTCAGCTACTCCGAGTCGTTCAACCCGAACGCCTATTCCGACGCCTCCGGCACGCCCCTGGCGCCCACCGAGGGCAAGCAGTGGGAACTCGGCCTGAAGTTCCAGGCGCCGGGCAGCAACAGCTTCTACACCGCCTCGCTGTTCCATATCACCCAGGAAAACGTCGCCTCCAAGGAACCCCAGGACAACTTCTACACCTCGGTCGGCGAAGTGCGCTCCCAGGGGCTCGAACTGGAGGCCCATACCCAGCTCAGCGACAACCTGAAACTGCTCGGCAGCTACACCTACACCGACATCACCTACACCAAGTCGCTGGACGGCAACCAGGGCCATACGCCGAACCAGGCGCCCAAGCACATGGCTTCGCTGTGGGCCGACTATGCCTTCGACGCCGGCCCGCTCAGCGGTCTGAGCATCGGCGGCGGCGCTCGCTACGTCGGCGAGACCTGGGCGGACAAGGAAAACACCTTGCGGGTGCCGGACTACACCCTGGTCGACGCGCGGATCGGTTACGACCTCGGCAAGCTCGGCCTGAAAGGCCTGGACGTCAGCCTCAATGCCAACAACCTGCTGGACAAGGACTACGTGGCGTCCTGCTACAGCCTGGACTTCTGCTACTTCGGCGAGAAGCGCAACGTCACCGCGACGGTGAACTACCAGTTCTGA


>PA3366|amiE
ATGCGTCACGGCGATATTTCCAGCAGCAACGACACCGTCGGAGTGGCGGTGGTCAACTACAAGATGCCGCGCCTGCACACCGCGGCGGAGGTCCTGGACAACGCCCGGAAGATCGCCGAGATGATCGTCGGCATGAAGCAGGGCCTGCCCGGCATGGACCTGGTGGTGTTCCCCGAGTACAGCCTGCAGGGCATCATGTACGATCCGGCGGAGATGATGGAAACCGCGGTGGCGATCCCCGGCGAGGAAACCGAGATATTCTCCCGCGCCTGCCGCAAGGCCAACGTCTGGGGCGTATTCTCCCTCACCGGCGAACGGCACGAGGAGCATCCGCGCAAGGCGCCGTACAACACCCTGGTGCTGATCGACAACAACGGCGAGATCGTCCAGAAGTACCGCAAGATCATTCCCTGGTGCCCCATCGAGGGCTGGTATCCCGGTGGCCAGACCTACGTCAGCGAAGGGCCGAAGGGCATGAAGATCAGCCTGATCATCTGCGACGACGGCAACTACCCGGAAATCTGGCGCGACTGCGCGATGAAGGGCGCCGAGCTGATCGTGCGCTGCCAGGGCTACATGTATCCGGCCAAGGACCAGCAGGTGATGATGGCCAAGGCCATGGCCTGGGCCAACAACTGCTATGTGGCGGTGGCCAACGCCGCCGGCTTCGACGGCGTGTATTCCTACTTCGGCCACTCGGCGATCATCGGCTTCGACGGTCGTACCCTCGGTGAGTGCGGCGAGGAGGAAATGGGTATCCAGTACGCCCAGCTGTCGCTTTCGCAGATCCGCGATGCGCGCGCCAACGATCAGTCGCAGAACCACCTGTTCAAGATCCTCCACCGCGGCTACAGCGGCTTGCAGGCGTCCGGCGATGGCGACCGGGGCCTGGCGGAGTGTCCGTTCGAGTTCTACCGCACCTGGGTCACCGACGCCGAGAAGGCGCGCGAGAATGTCGAGCGACTGACCCGCTCGACTACCGGTGTGGCGCAATGCCCGGTCGGCCGGCTGCCCTACGAGGGACTGGAGAAGGAGGCCTGA

>PA3372
ATGCGCCTGACCCTGCTCGGCACCGGCGACGCCCGCCAGGTGCCGGTCTACGGTTGCGATTGCCCGGCCTGTCGCAACGCCCGCGCCGACGCCGGCCTGCGTCGCCGTCCCTGTAGCGCGCTGCTGGAGTGCGCCGGCCAGCGCTGGCTGATCGACAGCGGCCTGGTCGATCTCTGTGAGCGCTTCCCGCCCCATAGCCTCGACGGCATCCTCCAGACCCATTACCACGCCGACCACGCCCAAGGCCTGCTGCACCTGCGCTGGGGCCAGGGCCTGGTGATCCCGGTGCACGGCCCGGCCGACCCGGAGGGCCTCGCCGACCTCTACAAGCATCCGGGCATCCTCGATTTCAGCCAGCCCTTCGGCGCCTTCGAGCGGCGCCAGTGGGGCGCGTTGGCGGCGACCGCGCTACCGCTGGTCCACTCGAAGCCGACCTTCGGCTACTTGCTGGAGGGGGCTTCCGAGGAGGGAACGATACGGCGTCTGGCCTACCTCACCGATACCGTCGGGCTGCCGGCGGACAGCGCCTCGCGATTGCTCGCGGCGCCGCTGGACCTGCTGGTGCTGGACTGCTCGATGCCGCCGCAGGAGCGGCCGCCGCGCAACCACAACGACCTGACGCGGGCATTGGAGTGCATCGAATCGCTGCGTCCCCGGCGGGCCGTGTTGACTCACGTCGGGCATGCGGTGGACGCCTGGCTGCTGGACCACCCCGCTGCGTTGCCCGAGGGGGTGGAACTGGCACACGACGGGATGTGCCTGCCGCTGTGA


>PA4524|nadC
ATGCCTAACCTCACCCTTGCCGACCTCCAAGGCGAAATCCAGGCCAACGTCCGCACCGCCCTGGCGGAAGACGTCGGCGGCGGCGACCTTACCGCTCAGTTGATCGATCCACAACGCGAGGCCGAGGCCCGGGTGATTACCCGCGAGCACGCGACGATCGCGGGCCGCGCCTGGGTCGACGAGGTCTTCCGCCAGGTCGATCCGCGAGTGCTGGTGACCTGGCAGGTGGAGGACGGCCAGCGAGTCGAGCCGAACCAGATGCTGTTCCAGCTAAAAGGTCCGGCCCGCGCGCTGCTCACCGGCGAGCGCAGCGCGCTGAACTTCCTCCAGCTGCTTTCCGGTACCGCTACCCGCAGCCAGCACTACGCCGACCTGGTCGCCGGCACCGCGGTGAAGCTCCTCGACACCCGCAAGACCCTGCCAGGCCTGCGCCTCGCGCAGAAGTACGCGGTCACCTGCGGCGGTTGCCACAACCATCGCATCGGCCTCTACGATGCCTTCCTGATCAAGGAAAACCACATCGCCGCCTGCGGCGGTATCGACCGGGCAATTGCCGAGGCCCGGCGCATAGCACCCGGCAAGCCGGTGGAAGTGGAAGTGGAGAACCTCGATGAACTGCGCCAGGCGCTGGAGGCCGGCGCCGATATCGTCATGCTCGACGAACTCAGCCTGGACGACATGCGCACCGCCGTCGCCCTCACCGCCGGCCGTGCCAAGCTGGAAGCTTCCGGCGGAATCAACGAGGGCACCCTGCGCAACATCGCCGAGACCGGCGTCGACTACATCTCCATCGGCACCCTGACCAAGGATGTCAGGGCCGTCGACCTGTCCATGCGCCTCACCCTCTGA

>PA4538|ndh
ATGTCCCATCGCATCGTGATCGTCGGCGGCGGCGCCGGCGGGCTGGAGCTCGCCACCCGTCTCGGCCGCACCCTGGGTAAACGCGGCAAGGCCCAGGTCACCCTGGTCGACGCCAACCTCACCCACATCTGGAAACCCCTGCTGCACGAAGTCGCTGCCGGCTCGCTCAACTCCTCCGAGGACGAGCTGAACTACGTCGCCCAGGCGAAGTGGAACCACTTCGAATTCCAGCTCGGCCGCATGCAGGGCCTGGATCGCGCCGGCAAGCGGGTCCGCCTGGCCGCACTGGTGGACGAGAATGGCGTTGAACTGGTTCCCGAGCGCGACATCGCCTACGACACCCTGGTGATCGCTGTCGGCAGCACCACCAACGACTTCGGCACCGAGGGCGCTGCGGAACATTGCATTTTCCTCGATACCCGCGCCCAGGCCGAACGCTTCCACCGACAACTACTCGGCCAGTACCTGCGTGCGCATACCGGGCACGACGCGAACAACAACGCAGTGAGTATCGCCATCATCGGCGCCGGCGCCACCGGCGTCGAACTGGCTGCGGAACTGCACCACGCCGCGCAGATGCTGGCCGCCTACGGGCTCGACCGGATCCGCCCGGAAGACCTGCACATCAGCCTGGTCGAAGCCGGCCCGCGGGTGCTGCCGGCGCTGCCCGAGCGTATCAGCCAGCCGGTACACCAGACCCTGAGCAAGCTCGGCGTACGGGTGATGACCGGCTCCGCGGTGAGCAAGGTAGATGCGGACGGCCTCTGGACCGGCGACGGCGAATTCGTCCCGGCGACGCTCAAGGTGTGGGCGGCGGGCATCCGGGCTCCGGCCTTCCTCAAGGAACTCGACGGCCTGGAAAGCAACCGTATCAACCAACTGGTGGTCCGCCCGACCCTGCAGACCACCCGCGACGACGACATCTTCGCCTTCGGCGACTGCGCCGCCTGTCCCCAGCCGGCGCAACCGGGAGAGCAACCGCGCAACGTGCCGCCACGCGCCCAGGCCGCGCACCAGCAGGCCTCGCTGCTGGTGAAATCGCTACGTGCCCGTCTCGAAGGCAAGCCGCTGGGCGAATATCACTACCGCGACTACGGTTCGCTGATCTCGCTGTCGCGCTTCAGCGCGGTCGGCAACCTGATGGGCAATCTGATGGGTAGCGTCATGCTCGAAGGCTGGCTGGCGCGGATGTTCTACGTATCGCTATACCGCATGCACCAGATGGCGTTGTACGGTCCGCTGCGCACCGCGATGCTGATGCTTAGCGGCCGCCTGCGCAGCACCGAGCCACGCCTCAAGCTGCACTGA


>PA4535
TGAACGAAGCGGATTATCTGCGCCTGCTCACCCGTCAGGCCGAACAAGCCAACGACTTCCTCTCCAACGCACGTAAATGGGACCGCGAGCGCTGGGTCTGCCAGCGCTTCCTCGAAGCCCTCAACGTGCCCTATCGCCAGGAGGATTTCGCCGCCCCCGGGGAACAGCCGCCGGACGTCCTGTTCAAGGGTGCCGGCTTCGAGGTGTTCTTCGTCCTCGATGAAGGTCGCCGGCTGAACGAGGAGTGGCGCGAGGAACTGACCCGTCGCCGCCAGGCCGTCAGCCTGCGCCAACTGATCCGACGCGAAGAGCGGCCACAACGGATCGCCGCCGCCGAGCTGCAGGCACGACTGGCGCCAACCCTGCGCAAGAAGGCGCACAACTATAGCGAGCGCGGCATCGACCACGGCGAACTGGACCTGCTGGCCTTCGTCAACCTGAAGCGCGCGGTGCCCGATTTCAATACGCCCTTCCCGCCGCCCACCGAATACCTGCGCCAAGGCTGGCGCTCTCTGTCGATGGTCGGTCCGACCTTTGCCCGGGTGCTCTTCGCTCACTCCGGCGCCCCCGAATTCCTGCGCGCCAACCTCGGCCGCAGCATCCTGTTCGACGCCGGGGTAGGCCTGTGA

>PA5149
ATGACCCCATCCCTCTCTGGCCTGCCTCCGATCCGCACCGCGTTGATCGGCTACGGCTTCGCCGGCAAGACCTTCCACGCCCCGCTGATCCGCGCGGTACCGGCGTTGTGCCTGGAGCACGTGGTCTCCCGCGACCCTGGGCGGGTGCACGCCGACCTGCCCGAAGCCCGGGTCAGCGCCGATCCGGATGAGGCCATCGAGGCCGCCGACATCGACCTGGTGGTCATCGCCTCGCCCAATGCCACCCACGCCAGCCTCGCCGAACGGGCCTTGCGCGCCGGCAAGCACGTGGTGGTGGACAAGCCGTTCACCGTCACCCTGGCCGAAGCCCGGCGCCTCGCCGACCTCGCCCGTGAACGGCCTGGGCAGGTCCTCTCGGTGTTCCAGAACCGGCGCTTCGACAGCGACTTCCTCGCCGTGGAGGCCGCCCTGCAGGCCGGCAGCATCGGCCCGGTGCGCTACTTCGAGTCGGCCATCGAGCGCTTCCGTCCGCAGGTCCGCGACCGCTGGCGCGAACACGACCTGCCCGGCTCCGGGCTGTGGTTCGACCTCGGCCCGCACCTGCTCGACCAGGCACTGTGCCTGTTCGGCGTACCGCAGCGTGTGCACGGACACCTGCGCCGGCTGCGCGAGGGCGCGCTGACCGACGACTGGTTCGAGGTCCTGCTCGATTATCCGCACTGCCAGGTAGCGCTGCGCGCCAGCATGCTCGCCGCCAATCCGGCGCCACGCTTCAATGTGCACGGCGACCACGGCAGCCTGCTCAAGGCCGGCGCCGACATCCAGGAAGCGCAACTGCTCCAGGGACTGCACCCCGGTTCCGCCGGCTGGGGCCGCGATCCCGACCTGCTGCAGCACATCGATGGCCAGGGCCTGCGCCAGTCGCTGGTCACCCCGGCCGGCGACCAGAGCCGCTACTACCAGGCGCTGGCCGCCGCCATCCGCGGCCAGTCGCGCAACCCGGTGTCGGCGCAACAGGCCTGCGCGCTGATGGCCCTGCTGGAGTTGGCACGACGCTCCGCCGAGGAAGGCCGGAGCCTGCCGGTGGAGCTGCGCGACGAGGAACGCCAGGCCTGGAACTGA

>PA5150
ATGGCGGAGAGAAAGACCCTGTTGCTGACCGGGGCGAGCCGCGGTATCGGGCATGCCACGGTGAAGTACTTCAATGCCGCGGGTTGGCGGGTGTTCACCGCGTCGCGGCAGAGCTGGGCCAGCGAATGTCCCTGGGCGGACGGCGAGGAAAACCACATCCATCTGGACTTGGAGGACATTCCCGGCGTCGAGGCCAGCCTGGAACTGATCCGCGAGAAGCTTGGCGACGGCCGGCTCCACGCGCTGGTGGACAATGCCGGCATCTCGCCCAAGGGCGAAGGCGGCGAGCGCCTCGGTGTGCTGGAAACCGACTACGCCACCTGGCTGCGGGTGTTCAACGTCAACCTGTTCTCCACCGCGCTGCTGGCGCGCGGCCTGTTCGCCGAGCTGAAGGCGGCGCAGGGAACGGTGATCAACGTGACCTCCATCGCTGGCTCGAAGGTGCATCCGTTCGCTGGGGTGGCCTACGCCACTTCCAAGGCGGCGTTGTCCGCGCTGACCCGCGAGATGGCCCACGACTTCGGCCCGCATGGGGTGCGGGTGAACGCCATCGCGCCGGGGGAGATCGACACCTCGATCCTGTCGCCGGGCACCGAGGAGATCGTCGAGCGCAGCATCCCGCTGCACCGCCTCGGCCGGCCGGAGGAGATCGCTTCGCTGATCTACTTCCTCTGCACCAGCGGCGCATCCTACGTGAATGGCGCGGAAATCCACGTCAACGGCGGGCAGCACGTCTAG


>PA3536
ATGGAGGAGGCGGGTTTCGGACCAGGGAGGTCGAACATGCACACGGGAGAAACACTCGCCGCCGCGCCGCCGGCACGGCCATTGCGCCAATCGCGGCTGGGCGGCCTGTCGCTGTTCCTCGCCCTGGCCGGGGTCGCCATCGCGCTGGCGGTGATGGCGCTGGCGCTCGGCGAGCGGATCGACCTCAGCGACGAGAACCATCTGCTCGGCCTGTTCGCCGCCTTGCTGGCGGTCTTCGCGGTATCGACCTGCGGCCTGGTGCTGGGCCTGGCCGGCCTGCTCAGGCGCAGCCGCAAGCGTCACCTGGCCCTGGCCGGCATCGTCCTCAACCTGTCGTGCCTGCTCTGGGGCTGGCATGCGCTGAGCACGGCGGCGGCCGCGATCCTGATGGTCCTGGGGCAAACCGGGTTGTCGTTCCTCAGCGCCCTGGCGGTGCTGTTCGGCATGATCTTCTTCCGCCAGGCCTGA

>PA3537|argF
ATGAGCGTACGGCACTTTCTCTCGTTTATGGATTACAGCCCCGAAGAGCTGATCGGTCTGATCCGCCGCGGCAGCGAGCTGAAGGACCTGCGCAACCGAGGCGTGCTCTACGAGCCGCTGAAGAGCCGGGTCCTGGGCATGGTCTTCGAGAAGGCTTCGACCCGTACCCGCCTGTCCTTCGAAGCCGGGATGATCCAGCTCGGCGGCCAGGCGATCTTCCTCTCCCCGCGCGACACCCAGCTCGGCCGCGGCGAGCCGATCGGCGACAGCGCCCGGGTCATGTCGCGGATGCTCGACGGCGTGATGATCCGCACCTTCGCCCACGCCACCCTGACGGAATTCGCCGCGCACTCGAAGGTGCCGGTGATCAACGGCCTGTCCGACGACCTGCACCCCTGCCAGTTGCTCGCCGACATGCAGACCTTCCACGAGCACCGCGGCAGCATCCAGGGCAAGACCGTGGCCTGGATCGGCGACGGCAACAACATGTGCAACAGCTATATAGAAGCGGCGCTGAAGTTCGACTTCCAGCTGCGCGTGGCCTGCCCCGAGGGCTACGAGCCGAAGGCCGAGTTCGTCGCCCTTGCCGGCGACCGCCTGCGCGTCGTCCGCGACCCGCGCGAGGCGGTGGCCGGCGCGCACCTGGTGAGCACCGACGTGTGGGCCTCGATGGGCCAGGAAGACGAAGCCGCCGCGCGCATCGCCCTGTTCCGTCCCTACCAGGTGAACGCCGCGTTGCTCGATGGGGCCGCCGACGATGTACTATTCATGCACTGCCTGCCGGCCCACCGCGGCGAGGAAATCAGCGAAGAGTTGCTGGACGACCCGCGCTCGGTAGCCTGGGACCAGGCAGAGAACCGTCTGCACGCGCAGAAGGCCCTCCTCGAATTGCTGATCGAACACGCCCATTACGCCTGA

% python3 ./bin/blastscript.py /Users/jonathanallen/Documents/genomes/fna/Pseudomonas_aeruginosa_refseq /Users/jonathanallen/Desktop/synteny/tRNA-Arg.txt /Users/jonathanallen/Desktop/synteny/tRNA-Arg.BLAST.txt 95 95


##########
##STEP2##
##########
####Create GBK trim coordinate File. 
####Run in jupyter notebook
####<code below>

'''
This code with parse through blastscript.py output from 2 query sequences 
This is a BLAST format 6 tsv file
The data will have two lines for each genome, one for each query
This finds the combined min/max coordinates (of the 2 query sequences) for each genome
Creates a single line with the genome min max data for each genome.
'''

filename="/Users/jonathanallen/Desktop/synteny/tRNA-Arg.BLAST.txt"
tempfile=open(filename,'r')
tempfile2=tempfile.read().splitlines()
reflist=[]
i=0
z=len(tempfile2)-1
for i in range (0,z):
    q1=tempfile2[i].split("\t")[1]
    q2=tempfile2[i+1].split("\t")[1]
    if q1==q2:
        templist=[]
        st1=tempfile2[i].split("\t")[8]
        sp1=tempfile2[i].split("\t")[9]
        st2=tempfile2[i+1].split("\t")[8]
        sp2=tempfile2[i+1].split("\t")[9]
        minimum_value = min(st1, sp1, st2, sp2)
        maximum_value = max(st1, sp1, st2, sp2)
        templist.append(q1)
        templist.append(minimum_value)
        templist.append(maximum_value)
        reflist.append(templist)
    i=i+2

output_file = open('/Users/jonathanallen/Desktop/synteny/tRNA-Arg.BLAST.parse.txt', 'w')
i=0
for entry in reflist:
    print(reflist[i][0]+"\t"+
          reflist[i][1]+"\t"+
          reflist[i][2], file=output_file)
    i=i+1
output_file.close()  

##########
##STEP 3##
##########
####Run gbktrim.ipynb through jupyter notebook
####<code below>

import os
from pathlib import Path

home = str(Path.home())
os.makedirs(home + "/Desktop/synteny/GBKtrim", exist_ok=True)
os.makedirs(home + "/Desktop/synteny/GBKtrim/temp", exist_ok=True)
outfiledir=home+"/Desktop/synteny/GBKtrim/"


infile = "/Users/jonathanallen/Desktop/synteny/tRNA-Arg.BLAST.parse.txt"
gbktrimfile=open(infile).readlines()
masterfile=[]
tempfile=[]
reflist=[]
x=0
i=0

for line in gbktrimfile:
    if i<len(gbktrimfile)-x:
        splitline=line.split("\t")
        genome=splitline[0].split("*")[0]
        tempstartcoord=splitline[1]
        tempendcoord=splitline[2]
        if tempstartcoord>tempendcoord:
            startcoord=int(tempendcoord)+5000
            endcoord=int(tempstartcoord)-5000
        else:
            startcoord=int(tempstartcoord)-5000
            endcoord=int(tempendcoord)+5000
        gbkfilename="/Users/jonathanallen/Documents/genomes/gbff/Pseudomonas_aeruginosa_refseq/"+genome+".gbff"
        outfilename=outfiledir+genome+"_trim.gbk"
        %run /Users/jonathanallen/bin/genbank_slicer.py -g $gbkfilename -o $outfilename -s $startcoord -e $endcoord
    i=i+1


##########
##STEP 4##
##########
####RUN SPINE
#NOTE1: Too computationally intense to use all strains. Instead use representative strains with shortest and longest loci (as determined by _trim.gbk file size)
#NOTE2: Pipeline works best if you remove a small portion of the "core" in the *.backbone.fasta file. That way, strains with only core (i.e., no accessory genes at the loci) still get sequence to run through the remaining pipeline. Doesn't change clustering, but makes pipeline run better. 
####<code below>

% perl ./bin/Spine-0.3.2/spine.pl -f /Users/jonathanallen/Desktop/synteny/spineinput_tRNA-Arg.txt -m ./bin/MUMmer3.23 -o /Users/jonathanallen/Desktop/synteny/spineoutput/pxr_tRNA-Arg.txt


##########
##STEP 5##
########## 
####see the python notebook script to create the -f and --annot files for CLUSTAGE and write the AGENT.sh script
####<code below>

# This script reads the folder with the trimmed .gbk files and formats a shell script to run AGEnt iterively on those files.

AgentMasterList=["# Change permissions on your computer so that you can run a shell script by typing: 'chmod 777 agent.sh' (without the quotes) at the terminal prompt "]
AccFastaMasterList=[]
AccLociMasterList=[]

import os
for subdir, dirs, files in os.walk("/Users/jonathanallen/Desktop/synteny/GBKtrim"):
    for file in files:
        filename=subdir+os.sep+file
        strain=filename.split("/")[6].strip("_trim.gbk")
        AgentLine="perl /Users/jonathanallen/bin/AGEnt-0.3.1/AGEnt.pl -r /Users/jonathanallen/desktop/synteny/spineoutput/pxr_tRNA-Arg.txt.backbone.fasta -q " + filename + " -n /Users/jonathanallen/bin/MUMmer3.23 -o /Users/jonathanallen/desktop/synteny/agentoutput/"+ strain
        AccFastaLine="/Users/jonathanallen/Desktop/synteny/agentoutput/"+strain+"."+strain+".accessory.fasta"+"\t"+ strain
        AccLociLine="/Users/jonathanallen/Desktop/synteny/agentoutput/"+strain+"."+strain+".accessory_loci.txt"+"\t"+ strain
        AgentMasterList.append(AgentLine)
        AccFastaMasterList.append(AccFastaLine)
        AccLociMasterList.append(AccLociLine)
finished="echo 'AGENT Shell Script Complete!  High Five!!'"
AgentMasterList.append(finished)



# This code saves the AGENT.sh script
output_file = open('/Users/jonathanallen/Desktop/synteny/AGENT.sh', 'w')
i=0
for line in AgentMasterList:
    print(AgentMasterList[i].rstrip('\n'), file=output_file)
    i=i+1
output_file.close()  

# This code saves the ClustageAccFastaFiles.txt file
output_file = open('/Users/jonathanallen/Desktop/synteny/ClustageAccFastaFiles.txt', 'w')
i=0
for line in AccFastaMasterList:
    print(AccFastaMasterList[i].rstrip('\n'), file=output_file)
    i=i+1
output_file.close()

# This code saves the ClustageAccLociFiles.txt file
output_file = open('/Users/jonathanallen/Desktop/synteny/ClustageAccLociFiles.txt', 'w')
i=0
for line in AccLociMasterList:
    print(AccLociMasterList[i].rstrip('\n'), file=output_file)
    i=i+1
output_file.close()


##########
##STEP 6##
##########
####RUN AGENT (on each *_trim.gbk file) using the AGENT.sh shell script from above

% chmod 777 /Users/jonathanallen/Desktop/synteny/AGENT.sh 
% /Users/jonathanallen/Desktop/synteny/AGENT.sh


##########
##STEP 7##
##########
####RUN CLUSTAGE

% perl ./bin/ClustAGE.osx.v0.8/ClustAGE.pl -f /Users/jonathanallen/Desktop/synteny/ClustageAccFastaFiles.txt --annot /Users/jonathanallen/Desktop/synteny/ClustageAccLociFiles.txt -o /Users/jonathanallen/Desktop/synteny/clustageoutput/pxrL2 -p 


##########
##STEP 8##
##########
####RUN Clustage.R pipeline to:
	1. Generate a Hierarchial Clutering plot to visualize subelement clustering.
	2. Calculate Jaccard similarity index to determine strain relatedness
	3. Generate a Heatmap of Jaccard similarity
	4. Determine similarity cutoff to group similar strains
	5. Generate a similar group output file.  
#### <code below>

#INTRODUCTION----# Use this code to take ClustAGE subelements.csv output and determine strains that are identical in their AGEs#LOAD LIBRARIES----library(tidyverse)library(pheatmap)library(RColorBrewer)library(vegan)#IMPORT AND WRANGLE RAW DATA----#set our working directory, where are the files located.setwd("/Users/jonathanallen/Desktop/synteny/clustageoutput")#input the subelements.csv filesubelements<-read.csv("query_subelements.csv")#remove the -rank column from the dataframe, part of ClustAGE outputdf<-subset(subelements,select = -rank)#convert the data frame to a data matrix and add back strains as rownamessampleLabels<-df$genome #save the sample labelsdmat<-data.matrix(df) # convert the data frame to a matrixdmat<-subset(dmat, select = -genome) # remove the genome columnrownames(dmat)<-c(sampleLabels) # add back the strain names as the row names. #generate a heatmap of the presence/absence data for all subelements and strainspheatmap(dmat,color=c("grey90","red"),cex=0.3,width=5, height=5, filename = "query.subelement.plot.pdf") # create a heatmap(presence/absence) of the subelements for all strains#GROUP STRAINS BY JACCARD SIMILARITY INDEX----#calculate the jaccard similarity index and generate a heatmap of identical strainsjaccard.mat<-1-data.matrix(vegdist(dmat,method="jaccard")) #calculate the jaccard similarity index for all strains# write.csv(jaccard.mat,file="jaccard.mat.csv", row.names=TRUE)pheatmap(jaccard.mat,color=colorRampPalette(c("black","white","red"))(50),cex=0.3,width=5, height=5,filename = "query.jaccard.heatmap.pdf") # generate a heatmap#Determine Strain groups based on similarity index cutoff.cutoff=0.5xy<- t(combn(colnames(jaccard.mat),2))jaccard.pivot<-data.frame(xy,dist=jaccard.mat[xy]) # essentially generates pivot tablejaccard.pivot.filter<-jaccard.pivot %>% dplyr::filter(dist>=cutoff,X1 != X2)donotkeep<-unique(jaccard.pivot.filter$X2)'%not_in%'<-function(x,table) is.na(match(x,table,nomatch=NA_integer_))jaccard.pivot.filter.screened<-dplyr::filter(jaccard.pivot.filter,X1 %not_in% donotkeep)write.csv(jaccard.pivot.filter.screened,file="query.groups.csv", row.names=TRUE)uniquegroups<-unique(jaccard.pivot.filter.screened$X1) #ID the group representitive strainswrite.csv(uniquegroups, file="unique.query.groups.csv",row.names=TRUE)

#CONVERT GROUP GBK FILES TO FASTA FORMAT----library(seqinr)for (group in uniquegroups) {  entry<-str_c("/Users/jonathanallen/Desktop/pxr_locus_ID/gbktrim/Paer_",group,"_trim.gbk")  exit<-str_c("/Users/jonathanallen/Desktop/pxr_locus_ID/fastatrim/Paer_",group,"_trim.fasta")  gb2fasta(entry,exit)}


##########
##STEP 9##
##########
####Create a shell script to copy representative unique trimmed GenBank files to a dedicated folder to run Clinker
#### <code below>

# Copy unique GBKtrim files determined by the R Clustage analysis pipeline into a new folder for Clinker
CopyMasterList=["#!/bin/zsh"]

tempfile=open("/Users/jonathanallen/Desktop/synteny/clustageoutput/unique.query.groups.csv",'r')
tempfile2=tempfile.read().splitlines()
directory1="/Users/jonathanallen/Desktop/synteny/GBKtrim/"
directory2="/Users/jonathanallen/Desktop/synteny/UniqueGBKtrim/"
i=1
for i in range (1,len(tempfile2)):
    splitline=tempfile2[i].split(',')
    strain=splitline[1]
    source=directory1+strain+"_trim.gbk"
    destination=directory2+strain+"_trim.gbk"
    line="cp " + source + " " + destination
    CopyMasterList.append(line)
    i=i+1

output_file = open('/Users/jonathanallen/Desktop/synteny/Copy.sh', 'w')
i=0
for line in CopyMasterList:
    print(CopyMasterList[i].rstrip('\n'), file=output_file)
    i=i+1
output_file.close()


##########
##STEP 10#
##########
#### Run Clinker in miniconda3
#### <code below>

% source $HOME/miniconda3/bin/activate
% conda activate clinker
% clinker /Users/jonathanallen/Desktop/synteny/UniqueGBKtrim/*.gbk -p
